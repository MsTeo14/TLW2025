<!DOCTYPE html>
<html>
  <head>
    <!--
      This is a template for an Augmented Reality (AR) application
      using A-Frame and AR.js to display a 3D model on a marker.
    -->
    <title>Hexane Molecule AR</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jacksonkoh8/AR.js@99bda004452549e8a7576b9e7afc26992aa0104e/aframe/build/aframe-ar.js"></script>
    <script src="gesture-detector.js"></script>
    <script src="gesture-handler.js"></script>
    <script src="sky.js"></script>

    <style>
      /* Styles for the button container */
      .button-container {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 99;
      }

      /* Styles for the show/hide button */
      .toggle-btn {
        padding: 10px 20px;
        font-size: 16px;
        font-weight: bold;
        color: white;
        background-color: #3B82F6;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s ease;
      }

      .toggle-btn:hover {
        background-color: #2563EB;
      }
    </style>

    <script>
      // Function to toggle the visibility of the 3D model
      function toggleModelVisibility() {
        // Get the A-Frame entity by its ID
        const model = document.getElementById('hexane-model');
        
        // Get the current visible attribute value
        const isVisible = model.getAttribute('visible');
        
        // Toggle the visible attribute
        // A-Frame entities have a 'visible' attribute that can be set to true or false
        model.setAttribute('visible', !isVisible);
        
        // Update the button text based on the new state
        const button = document.getElementById('toggle-model-btn');
        if (model.getAttribute('visible')) {
          button.textContent = 'Hide 3D Model';
        } else {
          button.textContent = 'Show 3D Model';
        }
      }

      // We remove the alert() here as it is not a good user experience
      // and can cause issues in the browser environment.
    </script>
  </head>

  <body>
    <div id="skybtn">
      <button
        class="skybtn"
        id="skybtn"
        onclick="skyCTRL()"
      >X</button>
    </div>

    <!-- Container for the new show/hide button -->
    <div class="button-container">
      <button
        id="toggle-model-btn"
        class="toggle-btn"
        onclick="toggleModelVisibility()"
      >
        Hide 3D Model
      </button>
    </div>

    <a-scene
      arjs="sourceWidth: 1024; sourceHeight: 776; displayWidth: 1024; displayHeight: 776;"
      embedded
      renderer="logarithmicDepthBuffer: true;"
      vr-mode-ui="enabled: false"
      gesture-detector
      loading-screen="enabled: false"
      gltf-model="dracoDecoderPath: https://www.gstatic.com/draco/v1/decoders/;"
      id="scene"
    >
      <a-assets>
        <a-asset-item
          id="hexane-obj"
          src="hexane.obj"
        >
        </a-asset-item>
        <a-asset-item
          id="hexane-mtl"
          src="hexane.mtl"
        >
        </a-asset-item>
      </a-assets>

      <a-marker
        preset="hiro"
        raycaster="objects: .clickable"
        emitevents="true"
        cursor="fuse: false; rayOrigin: mouse;"
        id="markerA"
        smooth="true"
        smoothCount="50"
        smoothTolerance="0.1"
        smoothThreshold="1000"
      >
        <a-sky
          id="sky"
          color="#C0C0C0"
          opacity="0"
        >
        </a-sky>

        <a-entity
          id="hexane-model"
          obj-model="obj: #hexane-obj; mtl: #hexane-mtl"
          position="0 0 0"
          rotation="0 0 0"
          scale="0.4 0.4 0.4"
          class="clickable"
          gesture-handler
          visible="true"
        >
        </a-entity>

      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>
